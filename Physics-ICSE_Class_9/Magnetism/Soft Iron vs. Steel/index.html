<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electromagnet Core Physics Lab</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-slate-100">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- INLINE ICONS (Replacing lucide-react) ---
        const RotateCcw = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74-2.74L3 12" /><path d="M3 3v9h9" /></svg>
        );
        const Battery = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="10" x="2" y="7" rx="2" ry="2" /><line x1="22" x2="22" y1="11" y2="13" /></svg>
        );
        const Power = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18.36 6.64a9 9 0 1 1-12.73 0" /><line x1="12" x2="12" y1="2" y2="12" /></svg>
        );
        const ArrowRight = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="5" y1="12" x2="19" y2="12" /><polyline points="12 5 19 12 12 19" /></svg>
        );
        const ChevronsDown = ({ size = 24, strokeWidth = 2, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m7 13 5 5 5-5" /><path d="m7 6 5 5 5-5" /></svg>
        );
        const ChevronsUp = ({ size = 24, strokeWidth = 2, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m17 11-5-5-5 5" /><path d="m17 18-5-5-5 5" /></svg>
        );

        // --- MAIN COMPONENT ---
        const MagnetLab = () => {
            const [power, setPower] = useState(false);
            const [coreType, setCoreType] = useState('none'); // 'none', 'iron', 'steel'
            const [magnetized, setMagnetized] = useState(false);
            const [clipsState, setClipsState] = useState('tray'); // 'tray', 'attracted', 'falling'
            const [message, setMessage] = useState("Select a core material to begin.");

            // -- Realism: Domain Randomization --
            const randomAngles = useRef([...Array(12)].map(() => Math.floor(Math.random() * 360))).current;

            // -- Realism: Paperclip Physics --
            const CLIP_Positions = useRef(
                Array.from({ length: 12 }).map(() => ({
                    x: Math.random() * 100 - 50,
                    y: Math.random() * 20,
                    rotation: Math.random() * 180 - 90,
                    delay: Math.random() * 0.3,
                    dangleSpeed: 2 + Math.random() * 2
                }))
            ).current;

            // Game Loop / Physics Logic
            useEffect(() => {
                let timer;

                if (power) {
                    if (coreType !== 'none') {
                        setMagnetized(true);
                        setClipsState('attracted');
                        setMessage(coreType === 'iron'
                            ? "Current flowing. Field is aligning the Soft Iron domains perfectly."
                            : "Current flowing. Forcing the stubborn Steel domains into alignment.");
                    } else {
                        setMagnetized(false);
                        setClipsState('tray');
                        setMessage("Air core. The magnetic field is too weak to lift the clips.");
                    }
                } else {
                    if (coreType === 'steel' && magnetized) {
                        setClipsState('attracted');
                        setMessage("Power OFF. Steel's high retentivity keeps domains locked. It's now a Permanent Magnet.");
                    } else {
                        setMagnetized(false);
                        setClipsState('falling');
                        timer = setTimeout(() => setClipsState('tray'), 600);

                        if (coreType === 'iron') {
                            setMessage("Power OFF. Thermal agitation immediately scrambles Soft Iron domains (Low Retentivity).");
                        } else if (coreType === 'none') {
                            setMessage("Circuit Open.");
                        }
                    }
                }
                return () => clearTimeout(timer);
            }, [power, coreType]);

            const handleCoreChange = (type) => {
                setCoreType(type);
                setPower(false);
                setMagnetized(false);
                setClipsState('falling');
                setTimeout(() => setClipsState('tray'), 100);

                if (type === 'iron') setMessage("Soft Iron Core inserted. High Permeability.");
                if (type === 'steel') setMessage("Steel Core inserted. High Retentivity.");
                if (type === 'none') setMessage("Core removed.");
            };

            const handleReset = () => {
                setPower(false);
                setMagnetized(false);
                setCoreType('none');
                setClipsState('falling');
                setTimeout(() => setClipsState('tray'), 100);
                setMessage("Lab reset.");
            };

            return (
                <div className="flex flex-col items-center w-full min-h-screen bg-slate-100 p-4 font-sans text-slate-800">
                    <style>
                        {
                            ` @keyframes sway {
                                0% { transform: rotate(85deg); }
                                50% { transform: rotate(95deg); }
                                100% { transform: rotate(85deg); }
                            }

                            @keyframes flowDown {
                                0% { transform: translateY(-10px); opacity: 0; }
                                50% { opacity: 1; }
                                100% { transform: translateY(10px); opacity: 0; }
                            }

                            @keyframes flowUp {
                                0% { transform: translateY(10px); opacity: 0; }
                                50% { opacity: 1; }
                                100% { transform: translateY(-10px); opacity: 0; }
                            }

                            .clip-sway {
                                animation: sway 3s ease-in-out infinite;
                                transform-origin: top center;
                            }

                            .current-flow-down { animation: flowDown 1s linear infinite; }
                            .current-flow-up { animation: flowUp 1s linear infinite; }
                            `
                        }
                    </style>

                    {/* Header */}
                    <header className="mb-6 text-center max-w-3xl">
                        <h1 className="text-3xl font-bold text-slate-900 mb-2">Electromagnet Core Physics</h1>
                        <p className="text-slate-600">
                            Observe <span className="font-semibold text-blue-600">Magnetic Domains</span> to understand why Steel
                            becomes a permanent magnet while Soft Iron does not.
                        </p>
                    </header>

                    {/* Main Lab Interface */}
                    <div className="relative w-full max-w-5xl bg-white rounded-xl shadow-2xl overflow-hidden border border-slate-300 flex flex-col md:flex-row">

                        {/* Left: Simulation Canvas */}
                        <div className="flex-grow bg-slate-50 relative h-[500px] md:h-[600px] flex flex-col items-center border-b md:border-b-0 md:border-r border-slate-200 overflow-hidden">

                            <div className="absolute inset-0 opacity-5"
                                style={{ backgroundImage: 'radial-gradient(#475569 1px, transparent 1px)', backgroundSize: '20px 20px' }}>
                            </div>

                            {/* --- TOP: CIRCUIT & POWER SUPPLY --- */}
                            <div className="w-full h-24 bg-slate-200 border-b border-slate-300 flex items-center justify-center relative shadow-inner z-30">
                                {/* Battery Pack */}
                                <div className="flex items-center gap-4 bg-slate-800 p-3 rounded-lg shadow-lg border-2 border-slate-600 z-10">
                                    <div className="flex flex-col items-center">
                                        <span className="text-xs text-slate-400 font-mono mb-1">VOLTAGE</span>
                                        <div className="text-green-400 font-mono text-xl font-bold tracking-widest">
                                            {power ? "12.0V" : "00.0V"}
                                        </div>
                                    </div>
                                    <div className="h-8 w-px bg-slate-600"></div>
                                    <Battery className={power ? "text-green-400 animate-pulse" : "text-slate-500"} size={32} />
                                </div>
                            </div>

                            {/* --- MIDDLE: THE ELECTROMAGNET & FIELD --- */}
                            <div className="relative flex-grow w-full z-20">

                                {/* SVG Layer for Field Lines and Wires */}
                                <svg className="absolute w-full h-full pointer-events-none overflow-visible" viewBox="0 0 800 600" preserveAspectRatio="xMidYMid slice">

                                    {/* Magnetic Field Lines */}
                                    <g style={{ opacity: magnetized ? 0.6 : 0, transition: 'opacity 0.5s ease-in-out' }}>
                                        {/* Right (North) to Left (South) Loops */}
                                        <path d="M 500 250 C 700 250, 700 500, 400 500 C 100 500, 100 250, 300 250" fill="none"
                                            stroke="#3b82f6" strokeWidth="2" strokeDasharray="10,10"
                                            className="animate-[pulse_3s_infinite]" />
                                        <path d="M 500 250 C 750 200, 750 600, 400 600 C 50 600, 50 200, 300 250" fill="none"
                                            stroke="#3b82f6" strokeWidth="2" strokeDasharray="15,15"
                                            className="animate-[pulse_4s_infinite]" />

                                        {/* Top Loops */}
                                        <path d="M 500 250 C 650 250, 650 50, 400 50 C 150 50, 150 250, 300 250" fill="none"
                                            stroke="#60a5fa" strokeWidth="1.5" strokeDasharray="8,8" />
                                    </g>

                                    {/* Wires connecting coil to top */}
                                    <line x1="280" y1="-50" x2="280" y2="200" stroke="#ef4444" strokeWidth="6" />
                                    <line x1="520" y1="-50" x2="520" y2="200" stroke="#2563eb" strokeWidth="6" />
                                </svg>

                                {/* Current Flow Indicators */}
                                {power && (
                                    <div className="absolute inset-0 pointer-events-none">
                                        <div className="absolute left-[35%] top-[10%] text-yellow-400 current-flow-down flex flex-col gap-8">
                                            <ChevronsDown size={24} strokeWidth={3} />
                                            <ChevronsDown size={24} strokeWidth={3} />
                                            <ChevronsDown size={24} strokeWidth={3} />
                                        </div>
                                        <div className="absolute right-[35%] top-[10%] text-yellow-400 current-flow-up flex flex-col gap-8">
                                            <ChevronsUp size={24} strokeWidth={3} />
                                            <ChevronsUp size={24} strokeWidth={3} />
                                            <ChevronsUp size={24} strokeWidth={3} />
                                        </div>
                                    </div>
                                )}

                                {/* The Coil Assembly */}
                                <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 -mt-16">
                                    <div className="relative w-64 h-48 flex items-center justify-center">

                                        {/* 1. The Core (Insertable) */}
                                        <div className={`relative w-48 h-24 rounded flex flex-wrap content-center justify-center gap-1
                                            overflow-hidden transition-all duration-700 ${coreType === 'none' ? 'opacity-0 scale-95'
                                                : 'opacity-100 scale-100 shadow-2xl'}`} style={{
                                                    background: coreType === 'iron'
                                                        ? 'linear-gradient(135deg, #52525b 0%, #71717a 50%, #3f3f46 100%)' // Matte Iron
                                                        : 'linear-gradient(135deg, #94a3b8 0%, #e2e8f0 50%, #64748b 100%)', // Shiny Steel
                                                    boxShadow: magnetized ? '0 0 30px rgba(59, 130, 246, 0.4)' : 'none'
                                                }}>

                                            <div className="absolute top-1 left-2 text-[10px] font-bold text-white/40 uppercase tracking-widest z-10">
                                                {coreType} Core
                                            </div>

                                            {/* MAGNETIC DOMAINS */}
                                            {coreType !== 'none' && randomAngles.map((angle, i) => (
                                                <div key={i}
                                                    className="w-8 h-4 flex items-center justify-center transition-transform duration-700 ease-[cubic-bezier(0.34,1.56,0.64,1)]"
                                                    style={{ transform: `rotate(${magnetized ? 0 : angle}deg)` }}>
                                                    <div className={`flex items-center ${magnetized ? 'opacity-90' : 'opacity-30'}`}>
                                                        <div className={`h-[2px] w-4 ${coreType === 'iron' ? 'bg-white' : 'bg-slate-800'}`}>
                                                        </div>
                                                        <div className={`w-0 h-0 border-t-[3px] border-t-transparent border-l-[6px]
                                                        border-b-[3px] border-b-transparent ${coreType === 'iron' ? 'border-l-white'
                                                                : 'border-l-slate-800'}`}></div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>

                                        {/* 2. Copper Windings */}
                                        <div className="absolute inset-0 pointer-events-none z-20 flex flex-col justify-between py-2">
                                            {[...Array(6)].map((_, i) => (
                                                <div key={i}
                                                    className="w-full h-4 bg-gradient-to-r from-amber-700 via-amber-500 to-amber-700 rounded-full shadow-sm transform scale-y-110 border-t border-amber-800 opacity-90">
                                                </div>
                                            ))}
                                        </div>

                                    </div>
                                </div>
                            </div>


                            {/* --- BOTTOM: TRAY & CLIPS --- */}
                            <div className="relative w-full h-40 flex justify-center items-end pb-4 bg-gradient-to-t from-slate-200 to-transparent z-30">
                                <div className="w-64 h-4 bg-slate-300 rounded-full shadow-lg border border-slate-400 absolute bottom-4 z-0"></div>

                                {/* Paperclips */}
                                {CLIP_Positions.map((clip, i) => {
                                    const isHanging = clipsState === 'attracted' || (clipsState === 'falling' && i % 2 !== 0);

                                    const targetY = isHanging ? -220 + clip.y * 2 : 0;
                                    const targetX = isHanging ? clip.x * 0.4 : clip.x;
                                    const targetRot = isHanging ? 90 : clip.rotation;

                                    return (
                                        <div key={i} className="absolute z-10" style={{
                                            bottom: '20px', left: '50%', marginLeft:
                                                `${targetX}px`, transform: `translateY(${targetY}px) rotate(${targetRot}deg)`, transition: isHanging
                                                    ? `all 0.4s cubic-bezier(0.17, 0.67, 0.83, 0.67) ${clip.delay}s` : `all 0.5s cubic-bezier(0.6,
                                    -0.28, 0.735, 0.045) ${clip.delay * 0.5}s`,
                                        }}>
                                            <div className={`w-3 h-10 border-[3px] border-slate-500 rounded-full bg-transparent origin-top
                                        ${isHanging ? 'animate-sway' : ''}`} style={{
                                                    borderColor: '#64748b', animationDuration:
                                                        `${clip.dangleSpeed}s`
                                                }}>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>

                        </div>

                        {/* Right: Controls & Dashboard */}
                        <div className="w-full md:w-80 bg-slate-800 text-slate-100 p-6 flex flex-col gap-6 border-l border-slate-700">

                            <div className="flex items-center gap-2 mb-2">
                                <div className={`w-3 h-3 rounded-full ${power ? 'bg-green-500 shadow-[0_0_10px_#22c55e]' : 'bg-red-500'}`}></div>
                                <h2 className="text-sm font-bold uppercase tracking-widest text-slate-400">Control Panel</h2>
                            </div>

                            {/* Status LCD */}
                            <div className="bg-black/50 border border-slate-600 rounded p-4 font-mono text-xs leading-5 min-h-[80px]">
                                <span className="text-green-400">{">"} SYSTEM_STATUS:</span><br />
                                <span className="text-slate-300">{message}</span>
                            </div>

                            <div className="space-y-6">

                                {/* Core Selector */}
                                <div>
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-3 block">1. Core Material</label>
                                    <div className="grid grid-cols-1 gap-3">
                                        <button onClick={() => handleCoreChange('iron')}
                                            className={`relative p-3 rounded border transition-all overflow-hidden ${coreType === 'iron'
                                                    ? 'bg-slate-600 border-slate-500 text-white ring-2 ring-slate-400'
                                                    : 'bg-slate-700 border-slate-600 text-slate-400 hover:bg-slate-600'
                                                }`}
                                        >
                                            <div className="relative z-10 flex items-center justify-between">
                                                <span className="font-bold">Soft Iron</span>
                                                <span className="text-[10px] bg-slate-900 px-2 py-1 rounded">Temporary</span>
                                            </div>
                                            <div className="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/concrete-wall.png')]"></div>
                                        </button>

                                        <button onClick={() => handleCoreChange('steel')}
                                            className={`relative p-3 rounded border transition-all overflow-hidden ${coreType === 'steel'
                                                    ? 'bg-blue-900 border-blue-700 text-white ring-2 ring-blue-500'
                                                    : 'bg-slate-700 border-slate-600 text-slate-400 hover:bg-slate-600'
                                                }`}
                                        >
                                            <div className="relative z-10 flex items-center justify-between">
                                                <span className="font-bold">Hard Steel</span>
                                                <span className="text-[10px] bg-black px-2 py-1 rounded border border-blue-500/30">Permanent</span>
                                            </div>
                                            <div className="absolute inset-0 bg-gradient-to-br from-transparent to-blue-500/20"></div>
                                        </button>

                                        <button onClick={() => handleCoreChange('none')}
                                            className={`p-2 rounded text-xs text-center border transition-all ${coreType === 'none'
                                                    ? 'bg-slate-700 border-slate-500 text-white'
                                                    : 'border-transparent text-slate-500 hover:text-slate-300'
                                                }`}
                                        >
                                            Remove Core
                                        </button>
                                    </div>
                                </div>

                                <hr className="border-slate-700" />

                                {/* Power Switch */}
                                <div>
                                    <label className="text-xs font-bold text-slate-400 uppercase mb-3 block">2. Power Source</label>
                                    <button onClick={() => setPower(!power)}
                                        className={`group w-full py-5 rounded-lg font-bold text-lg flex items-center justify-center
                                        gap-3 transition-all shadow-lg relative overflow-hidden ${power
                                                ? 'bg-red-600 text-white hover:bg-red-500'
                                                : 'bg-green-600 text-white hover:bg-green-500'
                                            }`}
                                    >
                                        <div className="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
                                        <Power size={24} className={power ? "animate-pulse" : ""} />
                                        <span className="relative z-10">{power ? 'CUT POWER' : 'ENERGIZE'}</span>
                                    </button>
                                </div>

                                <div className="pt-4 flex justify-center">
                                    <button onClick={handleReset}
                                        className="flex items-center gap-2 text-slate-500 hover:text-white text-xs font-medium px-4 py-2 rounded-full hover:bg-slate-700 transition-colors">
                                        <RotateCcw size={12} />
                                        RESET LAB
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>

                    {/* Legend / Key */}
                    <div className="mt-6 flex gap-6 text-slate-500 text-sm">
                        <div className="flex items-center gap-2">
                            <ArrowRight size={16} className="text-slate-800" />
                            <span>= Magnetic Domain</span>
                        </div>
                        <div className="flex items-center gap-2">
                            <div className="w-4 h-4 border-2 border-slate-400 rounded-full"></div>
                            <span>= Paperclip (Ferromagnetic)</span>
                        </div>
                        <div className="flex items-center gap-2">
                            <ChevronsDown size={16} className="text-yellow-600" />
                            <span>= Current Direction (+ to -)</span>
                        </div>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MagnetLab />);
    </script>
</body>

</html>
